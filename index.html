<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="utf-8">
  <title>cwajRSS 3.0 fresh cheese</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0" />
	<meta http-equiv="cache-control" content="max-age=180" />
	<link rel="stylesheet" href="css/telegap.css">
	
	<link rel="shortcut icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEACABoBQAAFgAAACgAAAAQAAAAIAAAAAEACAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAuj+EA8fj8AP39/gC92/UAzOP3AIrB7gCVxvAAi8HuAB6H4AAgh+AAFoLeANnr+QCayfAAm8nwAC6P4gAkiuAAJYrgAHK06wA9l+QA+Pv9AMLe9gBMn+YA0Ob4AL7c9AAbhd8AHIXfACqN4QD4+/4AK43hAO72/ADv9vwAeLfsADiV4wD8/v4A/f7+AP7+/gB/uuwAlcfwAFal5wAgiOAAIYjgACKI4AAYg94Ab7LrADCQ4gAli+AA8/n9AP7+/wAni+AA9fn9AD2Y5AA0k+IA+vz9AI3C7wCOwu8Aj8LvAE6g5gBDm+QAGIPfAMji9gAmi+EAHIbfACeL4QAdht8Aq9LzACuO4QD5/P4AhL3uADqW4wA8luMA///+AMDd9QBKnuUAzuX3AGGr6QArjuIALI7iACKJ4AAjieAA5/L7AOjy+wAwkeIA////APb6/QD3+v0ArNPyAGyx6QCGvu0AGYTfAFGh5gDT6PgAXanoACaM4QAojOEAVKTmACmM4QDs9fwAt9j1ADiU4wAtj+EAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUlJSUjdRPDw8PA9KC1IjUlJSTy0nPBAZGTw9GDoNUiMjHURTQA9BUlJOLlIaJwxSUkhXUhs/YlJJCEJSJzxYC0cnYxYkD1pGWTJSA008PEorPBAPXyUvMTwEUl4QPDwPRRAmFFJSEzAaAlIcPDw8PFxOByMiOyhdNFJbEDw8PDxMECBLPhAzISMXDzw8PDw8ODwpAEMBI1JVLTw8PDw8PDVOBVJSUlQ5Dzw8PDw8PCxgCh9hERJOEDw8PDw8PBA2UgZNTQ88PDw8PDw8PDwOUiNSVg88PDw8PDw8PDwJUFJSI1IGKhA8PDw8PCcVHlJSUlIjUmA1OExcRStHUiNSUgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=" />
		<link href="_/rssOne.png" rel="shortcut icon" type="image/x-icon" /> 
		<link rel="fluid-icon" href="_/rssOne.png" title="rssONE4" />
		<link rel="apple-touch-icon" sizes="57x57" href="_/rssOne.png" />
		<link rel="apple-touch-icon" sizes="114x114" href="_/rssOne.png" />
		<link rel="apple-touch-icon" sizes="72x72" href="_/rssOne.png" />
		<link rel="apple-touch-icon" sizes="144x144" href="_/rssOne.png" />
		<link rel="logo" type="image/svg" href="_/rssOne.svg" />	

<!--script type="text/javascript" charset="utf-8" src="cordova-3.1.0.js"></script-->
		
	<script type="text/javascript" src="http://www.google.com/jsapi"></script>
	<script type="text/javascript" charset="utf-8" src="rss.json.js"></script>
 	<script type="text/javascript" charset="utf-8" src="js/telegap.js"></script>
 	
<script type="text/javascript" charset="utf-8">



var sekcje=[];
var kolory=[];
var numer_kategorii=0;




var x___moje = 'eede2de857491ec7';
var x___self = false;
var menuOpen = false;
var zaladowany=false;

// The watch id references the current `watchAcceleration`
var watchID = null;
var showImages = window.localStorage.getItem('_showImages_') || 1;

	google.load("feeds","1");

    function onLoad() {
        document.addEventListener("deviceready", onDeviceReady, false);
		try {if (device.uuid) {document.getElementById('infotest').innerHTML=device.platform+'<br />'+device.uuid;}	}
		catch(err) {onDeviceReady();}

		
    }

	// ***********************************************************************************************************************
    function onDeviceReady() {
			if (zaladowany) return true;
			zaladowany=true;
		try {if (device.uuid == x___moje) x___self=true;}
		catch(er) {
			if (window.localStorage.getItem('___self___')=='ZnakZorro') x___self=true;
		}
		
		
		
		// instalacja klawiszy z JSON file do main menu
			var menu = document.getElementById('menu-batony'); 
			for (var r in rssy){
				sekcje[r]=rssy[r][0].sekcja;
				kolory[r]='#ffaa00';
					var baton = document.createElement('button'); 
					//baton.setAttribute('onclick','pokazFEED("'+r+'")');
					baton.setAttribute('rel-id',r);
					baton.addEventListener("click", pokazFEEDclick, false); 
					baton.innerHTML=sekcje[r] || rssy[r][0].kategoria || 'Sekcja'+r;
					baton.className='btn '+rssy[r][0].class;
					menu.appendChild(baton);
			}


pokazFEED(czytajID()); // else start programu start start start start start start start start start start 


// debug json test stringify debug json test stringify debug json test stringify 	
	/*
	var orssy=JSON.stringify(rssy);
	$('#test').innerHTML='<pre style="font-size:12px;">'+orssy+'</pre>';
	$('#test').style.display='block';
	*/

	

		//document.getElementById('feeddiv').innerHTML='<h1>Czekamy</h1>';
		document.addEventListener("resume", onResume, false);
		document.addEventListener("pause", onPause, false);
		document.addEventListener("online", onOnline, false);
		document.addEventListener("offline", onOffline, false);
		document.addEventListener("backbutton", onBackKeyDown, false);
		document.addEventListener("menubutton", onMenuKeyDown, false);		
		
        //pokazFEED(czytajID());
		document.getElementById("viewConfig").onclick=function(){viewConfig()};
		//document.getElementById("viewConfig2").onclick=function(){viewConfig()};
		
		// font
		var font_family = window.localStorage.getItem('_font_');
		var font_size   = window.localStorage.getItem('_font_size_') || 17;
		if (font_size || font_family){
			var sheet_font = document.createElement('style');
			sheet_font.innerHTML = 'body {';
				if (font_size)   sheet_font.innerHTML += 'font-size:'+font_size+'px;';
				if (font_family) sheet_font.innerHTML += 'font-family:"'+font_family+'";';
			sheet_font.innerHTML += '}';
			document.body.appendChild(sheet_font);			
			}
		// --font	
		
	//startWatch();
	if (showImages==0) $('#button_img').className='btn btn-mini btn-warning'; else $('#button_img').className='btn btn-mini btn-inverse';
	
	//applyBalanceText();	
	//$(window).resize(applyBalanceText);		
    } // onDeviceReady
	// ***********************************************************************************************************************
	
/*	
function applyBalanceText() {
	var container = $(".art");
	container.find("p").balanceText();
	container.find("h1").balanceText();
	container.find("a.title").balanceText();
	container.find(".hh1").balanceText();
}
*/



/////////////////////////////////////////


function zapakowany(ktory,ostatni){
	console.log(ktory+', '+ostatni);
	if (ktory===ostatni) pokazFEED(czytajID()); 
}



	function CzytajJsonLinki(result){
		var arkusz = result.feed.title.$t;
		var rss_links=[];
		for (var l in result.feed.entry){
			var entry=result.feed.entry[l];
			var content   = result.feed.entry[l].content.$t;
			var arr=content.split(',');
			var dane=[];
			for (var a in arr){
				var items=arr[a].split(': ');
				dane.push(items[1]);				
			}
			var kategoria=dane[0];
			var tytul=dane[1];
			var ile=parseInt(dane[4]);
			var status=parseInt(dane[3]);
			if (status>0){
				var rrr={kategoria:dane[0],title:dane[1],url:dane[2],limit:ile};
				rss_links.push(rrr);
			}
		}
		sekcje.push(arkusz);
		kolory.push('#963');
		rssy.push(rss_links);
		
	// instalacja klawiszy z gDocs do main menu
		var menu = document.getElementById('menu-batony'); 
		var baton = document.createElement('button'); 
		var nrfeed =rssy.length-1;
		baton.setAttribute('onclick','pokazFEED("'+nrfeed+'")');
		baton.innerText=arkusz;
		baton.className='btn btn-inverse';
		menu.appendChild(baton);
		
		
		
								//var orssy=JSON.stringify(rssy);
								//$('#test').innerHTML='<pre style="font-size:12px;">'+orssy+'</pre>';
								//$('#test').style.display='block';
		
		
	}
///////////////////////////
	
	
	
	
	
	function CzytajLinki(result){
		var rss_links=[];
		var rrr={};
		for (var l in result.feed.entries){
			var kategoria=result.feed.entries[l].title;
			var arr=result.feed.entries[l].content.split(',');
			var dane=[];
			for (var a in arr){
				var items=arr[a].split(': ');
				dane.push(items[1]);				
			}
			var tytul=dane[0];
			var link=dane[1];
			var ile=dane[2];	
			rrr={title:dane[0],url:dane[1],limit:parseInt(dane[2])};
			rss_links.push(rrr);			
		}
		//sekcje.push('gDocs');
		//kolory.push('#963');
		rssy.push(rss_links);
	} 
// links from gDocs by rss /////////////////////////
	
	
	
   
    function onResume() {
		//startWatch();
		//document.getElementById('test').innerHTML='onResume<br />';
    }
	
    function onPause() {
		//stopWatch();
		//document.getElementById('test').innerHTML='onPause<br />';
    }
	
    function onOnline() {
		//document.getElementById('test').innerHTML='onOnline<br />';
    }
	
	function onOffline() {
		//stopWatch();
		///////////////
		navigator.notification.alert(
		'You are the winner!',  // message
		alertDismissed,         // callback
		'Game Over',            // title
		'Done'                  // buttonName
		);
		///////////
		
		//document.getElementById('test').innerHTML='onOffline<br />';
		var id=czytajID();
		moveID(-1);
		rssfeedsetup(id);
    }
	
	function onBackKeyDown() {
		//document.getElementById('test').innerHTML='onBackKeyDown<br />';
		navigator.app.backHistory();
		//super.loadUrl("file:///android_asset/www/index.html");
		//console.log('onBackKeyDown');
		moveID(-1);
		var id=czytajID();
		//document.getElementById('test').innerHTML='onBackKeyDown '+opiszID();
		if (id) rssfeedsetup(id); else onMenuKeyDown();
		
    }
	
	function onMenuKeyDown() {
		if (menuOpen) {document.getElementById("menu").style.display="none"; zapal();menuOpen=false;}
		else          {document.getElementById("menu").style.display="block";zgas();menuOpen=true;}	
		if(timerKorki) clearTimeout(timerKorki);
    }
	
	function MenuZgas() {
		document.getElementById("menu").style.display="none"; zapal();menuOpen=false;
    }
    
 function czytajID(){
	var id=window.localStorage.getItem('__id__1') || '0';
	if (id==='undefined') id='0';
	return id;
}

function zapiszID(id){
	window.localStorage.setItem('__id__1',id);
	window.localStorage.setItem('last',id);
	//document.getElementById('test').innerHTML+='  Z='+opiszID();
}

function moveID(kier){
	var id1=window.localStorage.getItem('__id__1') || '0';
	var id2=window.localStorage.getItem('__id__2') || '0';
	var id3=window.localStorage.getItem('__id__3') || '0';
	if (id1==='undefined') id1='0';
	if (id2==='undefined') id2='0';
	if (id3==='undefined') id3='0';
	
//console.log('move= '+kier+'='+id1+' '+id2+' '+id3)	

	if (kier>0){
		window.localStorage.setItem('__id__1',id3);
		window.localStorage.setItem('__id__2',id1);
		window.localStorage.setItem('__id__3',id2);
	}	
	if (kier<0){
		window.localStorage.setItem('__id__1',id2);
		window.localStorage.setItem('__id__2',id3);
		window.localStorage.setItem('__id__3',id1);
	}
	//document.getElementById('test').innerHTML+='  M='+kier+'='+opiszID();
}

   	function gonext() {
   		//graj('page-mini.mp3');
		var idmax=rssy.length;
		var id=czytajID();
		id++;
		if (id>=idmax) id=0;
		zapiszID(id);
		rssfeedsetup(id);
		scroll_position=0;
		zapal();
	}
   	function goback() {
		//graj('page-mini.mp3');
		var idmax=rssy.length-1;
		var id=czytajID();
		id--;
		if (id<0) id=idmax;
		zapiszID(id);
		rssfeedsetup(id);
		scroll_position=0;
		zapal();
	}

   	function goforwad() {
		document.getElementById("menu").style.display="none";
		zapal();
		window.scrollTo(0,0);
		onMenuKeyDown();
	}
	
   	function goback___()   {
		document.getElementById("menu").style.display="none";
		zapal();
		window.scrollTo(0,0);
		onBackKeyDown();
	}

function koniec(){
	try  {navigator.app.exitApp();}
	catch(err) {
	  window.scrollTo(0,0);
	  }
	
}
   
    
	function uid(t){
		if (typeof(t) === 'undefined') return 'id'+999;
		var suma=0;
		for (var i in t) {suma+=t.charCodeAt(i);}
		return 'id'+suma;	
	}

	function uidiv(url,i,sekcja,kategoria){
		var feedcontainer=document.getElementById("feeddiv");
		var uniqueId=uid(url);	
		var el = document.createElement('article');
		el.className='col box';
		el.style.display='none';
		el.setAttribute("id",uniqueId);
		el.setAttribute("sekcja",sekcja);		//wlasciwie to zbedne
		el.setAttribute("kategoria",kategoria);	//wlasciwie to zbedne
		//el.setAttribute("title",rssy[sekcja][kategoria].title);
		el.setAttribute("tytul",rssy[sekcja][kategoria].title);
			// chache
			el.setAttribute('data-store','true');
			el.setAttribute('data-type','html');
			el.setAttribute('data-version','1');
			el.setAttribute('data-name',uniqueId);

		feedcontainer.appendChild(el);
		//console.log(el);
		
		//document.getElementById('menu'+i).setClass('k'+uniqueId);
	}

    
    function pokazFEEDclick(){
		var id = this.getAttribute('rel-id');
		pokazFEED(id);
	}
    
    function pokazFEED(id){
	
		if (!rssy[id]) {pokazFEED(0); return null;}
    	document.getElementById("menu").style.display="none";
		moveID(1);
    	rssfeedsetup(id);
    	zapal();
    }
    
    
    
    function rssfeedsetup(id){
	
		menuOpen=false;
		zapiszID(id);
		var godzin=window.localStorage.getItem('czas') || 24;
		$('#h'+godzin).className='btn btn-mini active';
		var last=window.localStorage.getItem('last') || 0;

		if (last>0) $('#zaznacz_czas').className='btn btn-mini active'; else $('#kasuj_czas').className='btn btn-mini active';
		kasuj();
		document.getElementById("feeddiv").innerHTML='<h2 id="title"><button onClick="goback();"  class="btn btn-next"> \u00AB  </button> '+sekcje[id]+' / '+godzin+'h <button onClick="gonext();"  class="btn btn-back"> \u00BB  </button></h2>';
		numer_kategorii=0;
		for(var i in rssy[id]) {
			var v = rssy[id][i].url;
			if (!v) continue;	//qqqqqqqqqqqqqqqqqqqqqqqqq nowe
			//console.log(rssy[id][i]);
			var feedlimit=rssy[id][i].limit || 6;
			var j=parseInt(i)+1;
			uidiv(v,j,id,i);
			numer_kategorii++;
			var feedpointer=new google.feeds.Feed(v);
			//feedpointer.includeHistoricalEntries()
			feedpointer.setNumEntries(feedlimit);
			feedpointer.load(displayfeed);
		}
		//dodajCache();
		
		// todo kontrola czy zaladowany a nie timeout
		setTimeout(function(){akcjastart();},1000);
    }
    	
 //==============================000000000000000000000000000===========================================   	
    function displayfeed(result){
		var id=czytajID();
		var sekcja=sekcje[id];
		
		var parentlink = result.feed.link;
//console.log(sekcja+' '+result.feed.title+' '+parentlink);
		if (parentlink) var	arrpl=parentlink.match(/http:\/\/(.*?)\//g);
		if (arrpl != null){
			var __parentlink = arrpl[0];
			__parentlink = __parentlink.replace(/http:\/\//,'')
		} else { var __parentlink = parentlink;}
		var godzin=window.localStorage.getItem('czas') || 24;
		var last=window.localStorage.getItem('last') || 0;
			var title = result.feed.title || 'Portal';	
			if (sekcja != 'WIZUT') {
				//var arr=title.split(' '); arr=arr.slice(0,3); title=arr.join(' ');
				title = title.replace('Zachodniopomorski Uniwersytet Technologiczny','ZUT');
				title = title.replace('Kanał RSS','');
				}
			if (title.length>40) {var arr=title.split(' '); arr=arr.slice(0,5); title=arr.join(' ');}
		
		var kolor=kolory[id];
		var uniqueId=uid(result.feed.feedUrl);
		var el  = document.getElementById(uniqueId);
var icolors	= id % flatuicolors.length;
kolor = flatuicolors[icolors].val;
var textcolor = flatuicolors[icolors].alt;
document.getElementById("title").style.backgroundColor = kolor;
document.getElementById("title").style.color = textcolor;
var m = uniqueId.match(/\d\d\d/);
if (typeof(m[0])){
	kolor = flatuicolors[m[0] % flatuicolors.length].val;
	textkolor = flatuicolors[m[0] % flatuicolors.length].alt;
} else {kolor='#369'; textkolor ='#fff';}
//title=+'xx';



		var rssheader='';
		rssheader+='<div class="hh1 box  inshadow" style="background:'+kolor+'; color:'+textkolor+'">';
		
			rssheader+='<a href="'+parentlink+'" title="'+__parentlink+'"><span class="pull-left"><span class="tytul">'+title+'</span></span></a>';
			//rssheader+='<span class="pull-right"><button class="btn btn-info btn-small">&#8657; top</button></span>';
		rssheader+='</div>';
		
		var thefeeds=result.feed.entries;
		
		var rssoutput='<div class="arty box">';
		var j=0;
		var ilefeeds=thefeeds.length;
		//var ftitle=rssy[id][i].title;


			
		for (var i=0; i<ilefeeds; i++) {
			j=i+1;
			var klasa=sekcja;
					// czas  -----------------------------------------
					if (!thefeeds[i].publishedDate) thefeeds[i].publishedDate = Date.now();
					var delta = deltaCzas(thefeeds[i].publishedDate);
					//console.log(thefeeds[i]);
					//console.log('pubDate='+thefeeds[i].publishedDate+' delta='+delta+' godzin='+godzin+' title='+title);
					if (delta>godzin) continue;
					// ostatnio
					//var rssczas = new Date(thefeeds[i].publishedDate);
					//var teraz=Date.parse(rssczas);
					//console.log('pubDate='+thefeeds[i].publishedDate+' last='+last+' teraz='+teraz+' title='+title);
					//if (last>teraz) continue;

					// czas  ostatnio -----------------------------------------
// konieczne todo korekta dla Agory
			var link  = korekta_link(thefeeds[i].link,thefeeds[i].content);

			var image=null;
			if (showImages==1) {image = szukaj_img(thefeeds[i].link,thefeeds[i].content);}
			var theContent=thefeeds[i].contentSnippet;
			//var theContent=thefeeds[i].content;
			//console.log(theContent);
//if (link.indexOf('gizmodo') > 1) theContent=modGizmo(theContent);
		if (image) klasa+=' imag';

			rssoutput+='<div class="art '+klasa+'">';
			rssoutput+="<button class='btn btn-small pull-right czas' rel-title='" + thefeeds[i].title + "'  rel-link='" + link + "' rel-lokalizacja='"+result.feed.title+"' rel-sekcja='"+sekcja+"' onClick='popup_open(this);'>";
				rssoutput+=toDate(thefeeds[i].publishedDate);
			rssoutput+="</button>";
			rssoutput+="<a href='javascript:void(0);' onClick='loadURL(\""+link+"\");' class='title'  target='_blank' rel='external' >"+j+". " + thefeeds[i].title + "</a>";
			rssoutput+="<div class='well'>";		
				if (image) rssoutput+="<div class='image'>"+image+"</div>";
				rssoutput+=theContent;		
			rssoutput+="</div>";		
			rssoutput+='</div>';
		}
		rssoutput+='</div>';

		if (rssoutput.length<50) {
			rssheader='';
			rssoutput='<p class="title"><a href="'+parentlink+'" title="'+__parentlink+'"> &nbsp; \u2248 <span class="tytul"'+title+'</span>&nbsp; \u2248 </a></p>';
			if ($('#'+uniqueId)) $('#'+uniqueId).className='col pusty';
			}
			
		if ($('#'+uniqueId))	
		{
			el.innerHTML+=rssheader+rssoutput;
			el.style.display='inline-block';
			// podmiana tytułów na natywne
			var t = el.getAttribute('tytul');
			var span = el.getElementsByClassName('tytul');
			span[0].innerHTML=t;
		}
		
    }
// =================================================================	
 
 
 
 
// QQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQ
//todo ustawienie rozłożenia na stronie
function akcjastart(){
//return false;
	var width = document.getElementById('feeddiv').offsetWidth;
	//console.log(' feedwidth= '+width);
	
	var articles = document.getElementsByTagName('article');
	var articles = document.getElementsByClassName('col box');
	var wymiary=[];
	var ile=articles.length;
	if (ile>8) return null;
	// ladujemy wymiary i rozmiary
	for (var a in articles){
		if (typeof(articles[a]) !='object') continue;
		var aid  = articles[a].id;
		var owidth  = articles[a].offsetWidth;
		var oheight = articles[a].offsetHeight;
		var oleft   = articles[a].offsetLeft;
		var otop    = articles[a].offsetTop;
		wymiary[a]={id:aid,w:owidth,h:oheight,l:oleft,t:otop}
		//console.log(a+' owidth= '+owidth+' oheight= '+oheight+'    oleft= '+oleft+' otop= '+otop);
		//width = document.getElementById('obrazki').offsetWidth;
	//var span = el.getElementsByClassName('tytul');
	}
	var kolumn = Math.floor(width/owidth);
	if (kolumn<4) return null;
	
	//console.log('ile='+ile+' kolumn='+kolumn);
	//console.log(wymiary);
	var nowewymiary=[];
	// rozkladamy wymiary w tablice tak jak w kolumnach
	for (var n=0; n<ile; n++){
		var row=Math.floor(n/kolumn);
		var col=n%kolumn;
		if (col==0) nowewymiary[row]=[];
		nowewymiary[row][col]= wymiary[n];
	}
	//console.log(nowewymiary);
	//var s=JSON.stringify(nowewymiary);
	//console.log(s);
	//document.getElementById('test').style.display='block';
	//document.getElementById('test').innerHTML='<textarea>'+s+'</textarea>';
	
	// wstawiamy nowe wymiary dla article
	for (var r=1; r<nowewymiary.length; r++){
		//console.log(nowewymiary[r].length);
		for (var rr=0; rr<nowewymiary[r].length; rr++){
			//console.log(nowewymiary[r-1][rr]);
			//console.log(nowewymiary[r][rr]);
			// delta przesunięcie
			var delta = nowewymiary[r-1][rr].h - nowewymiary[r][rr].t +90 ;
			//console.log(delta);
			if (delta>-300) continue;
			document.getElementById(nowewymiary[r][rr].id).style.top =delta+'px'
			document.getElementById(nowewymiary[r][rr].id).style.left = (owidth +40) * rr;
		}
	}
	
	// to trzeba zrobić inaczej 
	// skanować cele po kolumnach
}
 
 
 
 
 
 
 
 
 
 
function viewImages(){
	if (showImages==1) showImages=0; else showImages=1;
	if (showImages==0) $('#button_img').className='btn btn-mini btn-warning'; else $('#button_img').className='btn btn-mini btn-inverse';
	//console.log(showImages);console.log($('#button_img'));
	window.localStorage.setItem('_showImages_',showImages);
	window.location.reload();
}

	
 </script>
 
 </head>
 
 
 <body onload="onLoad()" onkeydown="klawisze(event)" id="body">




<div id="container">
    <div id="pullrefresh">
        <div class="message">
            <div id="pullrefresh-icon" class="icon arrow arrow-down"></div>
            <span></span>
        </div>
    </div>
	
 <div id="test" style="display:none; padding:0.5em; border:1px solid gray; background:#eee;"></div>
  
  <div id="feeddiv" class="wrapper fullwidth box inshadow"></div>	
	
 </div><!-- container-->  


	<!-- main menu-->
	   <div id="menu" style="width:100%; display:none; position:fixed; left:0; bottom:49px; background:#888; padding:2px; z-index:2;border-top:1px solid #444;"> 
		<span id="menu-batony">	</span>
		<button onClick="viewInfo();"   class="btn btn-warning">InfoSzczecin</button>	
		<button onClick="viewConfig();"   class="btn">Config</button>	
		<!--button onClick="deviceInfo();" class="btn btn-warning">device Info</button-->
		 &nbsp;   &nbsp;  
		<!--button onClick="koniec();"     class="btn btn-danger">Koniec</button-->
		<button onClick="viewKorkiWykres();"   class="btn btn-inverse btn-big">  Korki  </button>	
		
			<div class="batony" id="strefa_czasu">
				<button onClick="zaznacz_czas();"            class="h btn btn-mini btn-primary" id="zaznacz_czas" >0</button>
				<button onClick="ustawCzas(this);" rel="6"   class="h btn btn-mini btn-inverse" id="h6"   title="do 6 godzin">6h</button> 
				<button onClick="ustawCzas(this);" rel="12"  class="h btn btn-mini btn-inverse" id="h12"  title="do 12 godzin">12h</button> 
				<button onClick="ustawCzas(this);" rel="24"  class="h btn btn-mini btn-inverse" id="h24"  title="ostatnia doba">1d</button> 
				<button onClick="ustawCzas(this);" rel="168" class="h btn btn-mini btn-inverse" id="h168" title="ostatni tydzień">7d</button>
				<button onClick="ustawCzas(this);" rel="0"   class="h btn btn-mini btn-inverse" id="h0"   title="infinity">&infin;</button>
				<button onClick="kasuj_czas();"              class="h btn btn-mini btn-danger"  id="kasuj_czas">all</button>
			</div>	
	  </div> <!-- // main menu-->
  
 
<!--  
 <div class="hh1"><button onClick="scroll();" class="btn btn-info btn-small pull-right "> &#8657; top</button></div>
-->   



<!--xxx-->
<div class="complexBlock">
	<div id="prev"onclick="goback();"></div>
		<button onClick="onMenuKeyDown();" class="btn btn-primary">Menu</button>
		<button onClick="viewLSlinki(x___self);" class="btn btn-danger">Linki</button>
		<button onClick="viewRemotelinki(x___self);" class="btn">zURL</button>
		<button onClick="viewImages();" class="btn btn-mini btn-inverse" id="button_img" >img</button>
		<button onClick="window.location.reload();" class="btn btn-mini btn-primary">&#x21D5;</button> 		
	<div id="next" onclick="gonext();"></div>
</div>
<!--xxx-->




<div id='infotest'></div>
<br /><br /><br />


<div id="popup" class="box">
		<div id="popup_header"><h4 id="popup_title">Tytuł</h4> <a href="javascript:void(0)" class="btn btn-danger" onClick="popup_close();"> &nbsp; X &nbsp; </a></div>
		<div id="popup_body" class="box">  </div>
		<div id="popup_info"></div>
		<div id="popup_config"><span class="btn btn-info" id="viewConfig">Config</span></div>
		<div id="popup_menu"></div>
		<div id="popup_footer"> <a href="javascript:void(0)" class="btn btn-danger"  onClick="popup_close();">Close</a></div>
</div>

<div id="pilot">&#x21D5;</div>




<script>
//<div class="span4 well well-small" id="wi_aktualnosci" data-store="true" data-type="html" data-version="1" data-name="wi_aktualnosci"><div class="content">
/*
console.log('ix=');
function dodajCache(){
return
	var artyki=$('article');
	var ile=artyki.length;
	console.log(artyki);

	for (var a=0; a<ile; a++){
		var el=artyki[a];
		var id=el.id;
		//console.log(el);
		console.log('cache= '+el.id);
		el.setAttribute('data-store','true');
		el.setAttribute('data-type','html');
		el.setAttribute('data-version','1');
		el.setAttribute('data-name',id);
		
	};
}
*/

function klawisze(e){
	var k=e.keyCode;
//	console.log(k);
	if (k==39) gonext();
	if (k==37) goback();
	
	if (k==77) // klawisz m
		{
		console.log(k);		
		console.log(window);		
		console.log(screen.availWidth);
		console.log(screen.availHeight);
		window.screenTop=0;
		window.screenLeft=0;
		window.moveTo(0,0);
            if (window.outerHeight < screen.availHeight || window.outerWidth < screen.availWidth) {
                window.outerHeight = screen.availHeight;
                window.outerWidth = screen.availWidth;
            }
		}

	if (k==70) // klawisz f
		{ 
		var element=document.body;
		var requestMethod = element.requestFullScreen || element.webkitRequestFullScreen || element.mozRequestFullScreen || element.msRequestFullScreen;
		//console.log(requestMethod);
		element.webkitRequestFullScreen();
		}

}


/*
if (navigator.userAgent.toLowerCase().indexOf('chrome') > -1) {
console.log(navigator.userAgent.toLowerCase().indexOf('chrome'));
    var t = setInterval("resize()", 200);
	}
else
    resize();
*/
//var t=setInterval("resize()", 800);	
	
resize();
	
function resize() {

    var innerWidth = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;
    var innerHeight = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;
    var targetWidth = 800;
    var targetHeight = 600;
    window.resizeBy(targetWidth-innerWidth, targetHeight-innerHeight);
}



</script>

<!--
<script src="_/hammer.min.js"></script>
<script src="_/modernizr1.js"></script>
<script src="_/pull-to-refresh.js"></script>
-->	
  <div id="test2" style="display:none; padding:0.5em; border:1px solid gray; background:#eee;"></div>

	
  </body>
</html>
